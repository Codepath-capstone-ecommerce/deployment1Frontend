{"ast":null,"code":"import _regeneratorRuntime from\"/Users/kordellschrock/Documents/Github/deployment1Frontend/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/kordellschrock/Documents/Github/deployment1Frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/kordellschrock/Documents/Github/deployment1Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/kordellschrock/Documents/Github/deployment1Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/kordellschrock/Documents/Github/deployment1Frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Paper,Stepper,Step,StepLabel,Typography,Button}from\"@material-ui/core\";import{useState}from\"react\";import{makeStyles}from'@material-ui/core/styles';import PaymentForm from\"../PaymentForm/PaymentForm\";import AddressForm from\"../AddressForm/AddressForm\";import{useNavigate}from\"react-router-dom\";import{useAppStateContext}from'../../contexts/appStateContext';import apiClient from'../../services/apiClient';import Confirmation from\"../Confirmation/Confirmation\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{width:'100%'},button:{marginRight:theme.spacing(1)},instructions:{marginTop:theme.spacing(1),marginBottom:theme.spacing(1)},paper:{marginTop:theme.spacing(10),marginBottom:theme.spacing(10),marginRight:theme.spacing(40),marginLeft:theme.spacing(40),padding:theme.spacing(2)}};});var steps=[\"Delivery Info\",\"Payment Methods\"];export default function CheckOut(){var navigate=useNavigate();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeStep=_useState2[0],setActiveStep=_useState2[1];var classes=useStyles();var _useAppStateContext=useAppStateContext(),appState=_useAppStateContext.appState,setAppState=_useAppStateContext.setAppState,vendorState=_useAppStateContext.vendorState,setvendorState=_useAppStateContext.setvendorState;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),complete=_useState4[0],setComplete=_useState4[1];var _useState5=useState({first_name:\"\",last_name:\"\",address:\"\",email:\"\",postal_code:\"\"}),_useState6=_slicedToArray(_useState5,2),form=_useState6[0],setForm=_useState6[1];var emptyCart=function emptyCart(){setAppState(function(a){return _objectSpread(_objectSpread({},a),{},{cart:[],review:[]});});};var formatCart=function formatCart(){var obj={};for(var i=0;i<appState.cart.length;i++){if(appState.cart[i]in obj){obj[appState.cart[i]]+=1;}else{obj[appState.cart[i]]=1;}}return obj;};// console.log(prices)\nvar obj=formatCart();var items=[];for(var _i=0,_Object$entries=Object.entries(obj);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];items.push({name:key,quantity:value});}var cart=[];for(var _i2=0,_Object$entries2=Object.entries(obj);_i2<_Object$entries2.length;_i2++){var _Object$entries2$_i=_slicedToArray(_Object$entries2[_i2],2),_key=_Object$entries2$_i[0],_value=_Object$entries2$_i[1];var _obj={};_obj[_key]=_value;cart.push(_obj);}var createOrder=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$apiClient$crea,data,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return apiClient.createOrder({\"cart\":{address:form.address,products:cart}});case 2:_yield$apiClient$crea=_context.sent;data=_yield$apiClient$crea.data;error=_yield$apiClient$crea.error;setvendorState(function(oldState){return{currentOrders:[].concat(_toConsumableArray(oldState.currentOrders),[data])};});emptyCart();// if (error){\n//   setErrors((e) => ({ ...e, form:error}))\n// }\ncase 7:case\"end\":return _context.stop();}}},_callee);}));return function createOrder(){return _ref.apply(this,arguments);};}();var handleBack=function handleBack(){setActiveStep(function(prevActiveStep){return prevActiveStep-1;});};var handleNext=function handleNext(e){if(e.target.innerHTML===\"Finish\"){createOrder();}setActiveStep(function(prevActiveStep){return prevActiveStep+1;});};console.log(complete);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Paper,{className:classes.paper,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",children:\"Checkout\"}),/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsx(Stepper,{activeStep:activeStep,children:steps.map(function(label,index){return/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:label})},index);})})}),/*#__PURE__*/_jsx(\"div\",{children:activeStep===steps.length?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Confirmation,{}),/*#__PURE__*/_jsx(Typography,{className:classes.instructions,children:\"All steps completed - you're finished\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return navigate('/accountProfile');},children:\"Go to profile\"})]}):/*#__PURE__*/_jsxs(\"div\",{children:[activeStep===0?/*#__PURE__*/_jsx(AddressForm,{form:form,setForm:setForm,setComplete:setComplete}):/*#__PURE__*/_jsx(PaymentForm,{}),/*#__PURE__*/_jsxs(\"div\",{children:[activeStep===0?/*#__PURE__*/_jsx(Button,{onClick:function onClick(){navigate('/cart');},children:\"Back to Cart\"}):/*#__PURE__*/_jsx(Button,{onClick:handleBack,className:classes.button,children:\"Back\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleNext,className:classes.button,disabled:!complete,children:activeStep===steps.length-1?'Finish':'Next'})]})]})})]})});}","map":{"version":3,"sources":["/Users/kordellschrock/Documents/Github/deployment1Frontend/src/components/CheckOut/CheckOut.js"],"names":["Paper","Stepper","Step","StepLabel","Typography","Button","useState","makeStyles","PaymentForm","AddressForm","useNavigate","useAppStateContext","apiClient","Confirmation","useStyles","theme","root","width","button","marginRight","spacing","instructions","marginTop","marginBottom","paper","marginLeft","padding","steps","CheckOut","navigate","activeStep","setActiveStep","classes","appState","setAppState","vendorState","setvendorState","complete","setComplete","first_name","last_name","address","email","postal_code","form","setForm","emptyCart","a","cart","review","formatCart","obj","i","length","items","Object","entries","key","value","push","name","quantity","createOrder","products","data","error","oldState","currentOrders","handleBack","prevActiveStep","handleNext","e","target","innerHTML","console","log","map","label","index"],"mappings":"qsBAAA,OAASA,KAAT,CAAgBC,OAAhB,CAAyBC,IAAzB,CAA+BC,SAA/B,CAA0CC,UAA1C,CAAsDC,MAAtD,KAAoE,mBAApE,CACA,OAASC,QAAT,KAAyB,OAAzB,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,MAAOC,CAAAA,WAAP,KAAwB,4BAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,4BAAxB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,kBAAT,KAAmC,gCAAnC,CACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,YAAP,KAAyB,8BAAzB,C,6IAGA,GAAMC,CAAAA,SAAS,CAAGP,UAAU,CAAC,SAACQ,KAAD,QAAY,CACrCC,IAAI,CAAE,CACFC,KAAK,CAAE,MADL,CAD+B,CAIrCC,MAAM,CAAE,CACJC,WAAW,CAAEJ,KAAK,CAACK,OAAN,CAAc,CAAd,CADT,CAJ6B,CAOrCC,YAAY,CAAE,CACVC,SAAS,CAAEP,KAAK,CAACK,OAAN,CAAc,CAAd,CADD,CAEVG,YAAY,CAAER,KAAK,CAACK,OAAN,CAAc,CAAd,CAFJ,CAPuB,CAWrCI,KAAK,CAAE,CACHF,SAAS,CAAEP,KAAK,CAACK,OAAN,CAAc,EAAd,CADR,CAEHG,YAAY,CAAER,KAAK,CAACK,OAAN,CAAc,EAAd,CAFX,CAGHD,WAAW,CAACJ,KAAK,CAACK,OAAN,CAAc,EAAd,CAHT,CAIHK,UAAU,CAACV,KAAK,CAACK,OAAN,CAAc,EAAd,CAJR,CAKHM,OAAO,CAAEX,KAAK,CAACK,OAAN,CAAc,CAAd,CALN,CAX8B,CAAZ,EAAD,CAA5B,CAoBA,GAAMO,CAAAA,KAAK,CAAG,CAAC,eAAD,CAAkB,iBAAlB,CAAd,CAEA,cAAe,SAASC,CAAAA,QAAT,EAAoB,CAC/B,GAAMC,CAAAA,QAAQ,CAAGnB,WAAW,EAA5B,CACA,cAAoCJ,QAAQ,CAAC,CAAD,CAA5C,wCAAOwB,UAAP,eAAmBC,aAAnB,eACA,GAAMC,CAAAA,OAAO,CAAGlB,SAAS,EAAzB,CACA,wBAA8DH,kBAAkB,EAAhF,CAAQsB,QAAR,qBAAQA,QAAR,CAAkBC,WAAlB,qBAAkBA,WAAlB,CAA8BC,WAA9B,qBAA8BA,WAA9B,CAA2CC,cAA3C,qBAA2CA,cAA3C,CACA,eAA+B9B,QAAQ,CAAC,KAAD,CAAvC,yCAAO+B,QAAP,eAAgBC,WAAhB,eACA,eAAwBhC,QAAQ,CAAC,CAC7BiC,UAAU,CAAE,EADiB,CAE7BC,SAAS,CAAE,EAFkB,CAG7BC,OAAO,CAAC,EAHqB,CAI7BC,KAAK,CAAC,EAJuB,CAK7BC,WAAW,CAAC,EALiB,CAAD,CAAhC,yCAAOC,IAAP,eAAaC,OAAb,eAQA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpBZ,WAAW,CAAC,SAACa,CAAD,wCAEDA,CAFC,MAGJC,IAAI,CAAE,EAHF,CAIJC,MAAM,CAAE,EAJJ,IAAD,CAAX,CAOH,CARD,CAUA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACrB,GAAMC,CAAAA,GAAG,CAAG,EAAZ,CACA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGnB,QAAQ,CAACe,IAAT,CAAcK,MAAlC,CAA0CD,CAAC,EAA3C,CAA+C,CAC3C,GAAInB,QAAQ,CAACe,IAAT,CAAcI,CAAd,GAAoBD,CAAAA,GAAxB,CAA6B,CACzBA,GAAG,CAAClB,QAAQ,CAACe,IAAT,CAAcI,CAAd,CAAD,CAAH,EAAyB,CAAzB,CACH,CAFD,IAEO,CACHD,GAAG,CAAClB,QAAQ,CAACe,IAAT,CAAcI,CAAd,CAAD,CAAH,CAAwB,CAAxB,CACH,CACJ,CAED,MAAOD,CAAAA,GAAP,CACH,CAXD,CAaA;AACA,GAAMA,CAAAA,GAAG,CAAGD,UAAU,EAAtB,CACA,GAAMI,CAAAA,KAAK,CAAG,EAAd,CACA,6BAA2BC,MAAM,CAACC,OAAP,CAAeL,GAAf,CAA3B,gCAAgD,CAA3C,6DAAOM,GAAP,uBAAYC,KAAZ,uBACDJ,KAAK,CAACK,IAAN,CAAW,CAAEC,IAAI,CAAEH,GAAR,CAAaI,QAAQ,CAAEH,KAAvB,CAAX,EACH,CAED,GAAMV,CAAAA,IAAI,CAAG,EAAb,CACA,+BAA2BO,MAAM,CAACC,OAAP,CAAeL,GAAf,CAA3B,mCAAgD,CAA3C,gEAAOM,IAAP,wBAAYC,MAAZ,wBACD,GAAIP,CAAAA,IAAG,CAAG,EAAV,CACAA,IAAG,CAACM,IAAD,CAAH,CAAWC,MAAX,CACAV,IAAI,CAACW,IAAL,CAAUR,IAAV,EACH,CAED,GAAMW,CAAAA,WAAW,0FAAG,8LACclD,CAAAA,SAAS,CAACkD,WAAV,CAC1B,CACI,OAAQ,CACJrB,OAAO,CAAEG,IAAI,CAACH,OADV,CAEJsB,QAAQ,CAAEf,IAFN,CADZ,CAD0B,CADd,4CACRgB,IADQ,uBACRA,IADQ,CACFC,KADE,uBACFA,KADE,CAShB7B,cAAc,CAAC,SAAA8B,QAAQ,QAAK,CAAEC,aAAa,8BAAMD,QAAQ,CAACC,aAAf,GAA8BH,IAA9B,EAAf,CAAL,EAAT,CAAd,CACAlB,SAAS,GACT;AACA;AACA;AAbgB,sDAAH,kBAAXgB,CAAAA,WAAW,0CAAjB,CAgBA,GAAMM,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACrBrC,aAAa,CAAC,SAACsC,cAAD,QAAoBA,CAAAA,cAAc,CAAG,CAArC,EAAD,CAAb,CACH,CAFD,CAGA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,CAAD,CAAO,CACtB,GAAGA,CAAC,CAACC,MAAF,CAASC,SAAT,GAAuB,QAA1B,CAAmC,CAC/BX,WAAW,GACd,CACD/B,aAAa,CAAC,SAACsC,cAAD,QAAoBA,CAAAA,cAAc,CAAG,CAArC,EAAD,CAAb,CACH,CALD,CAOAK,OAAO,CAACC,GAAR,CAAYtC,QAAZ,EACA,mBACI,sCACI,MAAC,KAAD,EAAO,SAAS,CAAEL,OAAO,CAACR,KAA1B,wBACI,KAAC,UAAD,EAAY,OAAO,CAAC,IAApB,CAAyB,KAAK,CAAC,QAA/B,sBADJ,cAEI,YAAK,SAAS,CAAEQ,OAAO,CAAChB,IAAxB,uBACI,KAAC,OAAD,EAAS,UAAU,CAAEc,UAArB,UACKH,KAAK,CAACiD,GAAN,CAAU,SAACC,KAAD,CAAQC,KAAR,qBACP,KAAC,IAAD,wBACI,KAAC,SAAD,WAAYD,KAAZ,EADJ,EAAWC,KAAX,CADO,EAAV,CADL,EADJ,EAFJ,cAWI,qBACKhD,UAAU,GAAKH,KAAK,CAAC0B,MAArB,cACG,oCACI,KAAC,YAAD,IADJ,cAEI,KAAC,UAAD,EAAY,SAAS,CAAErB,OAAO,CAACX,YAA/B,mDAFJ,cAKI,KAAC,MAAD,EAAQ,OAAO,CAAE,yBAAIQ,CAAAA,QAAQ,CAAC,iBAAD,CAAZ,EAAjB,2BALJ,GADH,cASG,uBACKC,UAAU,GAAK,CAAf,cAAmB,KAAC,WAAD,EAAa,IAAI,CAAIc,IAArB,CAA2B,OAAO,CAAEC,OAApC,CAA6C,WAAW,CAAGP,WAA3D,EAAnB,cAA+F,KAAC,WAAD,IADpG,cAEI,uBACKR,UAAU,GAAG,CAAb,cAAgB,KAAC,MAAD,EAAQ,OAAO,CAAE,kBAAM,CAAED,QAAQ,CAAC,OAAD,CAAR,CAAmB,CAA5C,0BAAhB,cACD,KAAC,MAAD,EAAQ,OAAO,CAAEuC,UAAjB,CAA6B,SAAS,CAAEpC,OAAO,CAACd,MAAhD,kBAFJ,cAKI,KAAC,MAAD,EACI,OAAO,CAAC,WADZ,CAEI,KAAK,CAAC,SAFV,CAGI,OAAO,CAAEoD,UAHb,CAII,SAAS,CAAEtC,OAAO,CAACd,MAJvB,CAKI,QAAQ,CAAE,CAACmB,QALf,UAOKP,UAAU,GAAKH,KAAK,CAAC0B,MAAN,CAAe,CAA9B,CAAkC,QAAlC,CAA6C,MAPlD,EALJ,GAFJ,GAVR,EAXJ,GADJ,EADJ,CA8CH","sourcesContent":["import { Paper, Stepper, Step, StepLabel, Typography, Button } from \"@material-ui/core\"\nimport { useState } from \"react\"\nimport { makeStyles } from '@material-ui/core/styles';\nimport PaymentForm from \"../PaymentForm/PaymentForm\";\nimport AddressForm from \"../AddressForm/AddressForm\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAppStateContext } from '../../contexts/appStateContext';\nimport apiClient from '../../services/apiClient';\nimport Confirmation from \"../Confirmation/Confirmation\";\n\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        width: '100%',\n    },\n    button: {\n        marginRight: theme.spacing(1),\n    },\n    instructions: {\n        marginTop: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n    },\n    paper: {\n        marginTop: theme.spacing(10),\n        marginBottom: theme.spacing(10),\n        marginRight:theme.spacing(40),\n        marginLeft:theme.spacing(40),\n        padding: theme.spacing(2)\n    },\n}));\n\nconst steps = [\"Delivery Info\", \"Payment Methods\"]\n\nexport default function CheckOut() {\n    const navigate = useNavigate()\n    const [activeStep, setActiveStep] = useState(0)\n    const classes = useStyles();\n    const { appState, setAppState,vendorState, setvendorState } = useAppStateContext()\n    const [complete,setComplete] = useState(false)\n    const [form, setForm] = useState({\n        first_name: \"\",\n        last_name: \"\",\n        address:\"\",\n        email:\"\",\n        postal_code:\"\"\n      })\n\n    const emptyCart = () => {\n        setAppState((a) => (\n            {\n                ...a,\n                cart: [],\n                review: []\n            }\n        ))\n    }\n\n    const formatCart = () => {\n        const obj = {}\n        for (let i = 0; i < appState.cart.length; i++) {\n            if (appState.cart[i] in obj) {\n                obj[appState.cart[i]] += 1\n            } else {\n                obj[appState.cart[i]] = 1\n            }\n        }\n\n        return obj\n    }\n\n    // console.log(prices)\n    const obj = formatCart()\n    const items = []\n    for (const [key, value] of Object.entries(obj)) {\n        items.push({ name: key, quantity: value });\n    }\n\n    const cart = []\n    for (const [key, value] of Object.entries(obj)) {\n        let obj = {}\n        obj[key] = value\n        cart.push(obj);\n    }\n\n    const createOrder = async () => {\n        const { data, error } = await apiClient.createOrder(\n            {\n                \"cart\": {\n                    address: form.address,\n                    products: cart\n                }\n            }\n        )\n        setvendorState(oldState => ({ currentOrders: [...oldState.currentOrders, data] }))\n        emptyCart()\n        // if (error){\n        //   setErrors((e) => ({ ...e, form:error}))\n        // }\n    }\n\n    const handleBack = () => {\n        setActiveStep((prevActiveStep) => prevActiveStep - 1);\n    };\n    const handleNext = (e) => {\n        if(e.target.innerHTML === \"Finish\"){\n            createOrder();\n        }\n        setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    };\n\n    console.log(complete)\n    return (\n        <>\n            <Paper className={classes.paper}>\n                <Typography variant='h4' align='center'>Checkout</Typography>\n                <div className={classes.root}>\n                    <Stepper activeStep={activeStep}>\n                        {steps.map((label, index) => (\n                            <Step key={index}>\n                                <StepLabel>{label}</StepLabel>\n                            </Step>\n                        ))}\n                    </Stepper>\n                </div>\n                <div>\n                    {activeStep === steps.length ? (\n                        <div>\n                            <Confirmation></Confirmation>\n                            <Typography className={classes.instructions}>\n                                All steps completed - you&apos;re finished\n                            </Typography>\n                            <Button onClick={()=>navigate('/accountProfile')}>Go to profile</Button>\n                        </div>\n                    ) : (\n                        <div>\n                            {activeStep === 0 ? <AddressForm form = {form} setForm={setForm} setComplete= {setComplete}/> : <PaymentForm></PaymentForm>}\n                            <div>\n                                {activeStep===0? <Button onClick={() => { navigate('/cart') }}>Back to Cart</Button>:\n                                <Button onClick={handleBack} className={classes.button}>\n                                    Back\n                                </Button>}\n                                <Button\n                                    variant=\"contained\"\n                                    color=\"primary\"\n                                    onClick={handleNext}\n                                    className={classes.button}\n                                    disabled={!complete}\n                                >\n                                    {activeStep === steps.length - 1 ? 'Finish' : 'Next'}\n                                </Button>\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </Paper>\n        </>\n    )\n}"]},"metadata":{},"sourceType":"module"}